name: runtime-tests

services:
  runtime-mongo:
    image: mongo@sha256:ea783d8ac4dcac9f8a7ff236b26a52e36649fc1bdd1778ffb44ba5e4de776cda
    container_name: runtime-mongo
    ports:
      - "27021:27017"
    environment:
      MONGO_INITDB_ROOT_USERNAME: root
      MONGO_INITDB_ROOT_PASSWORD: example

  runtime-postgres:
    image: ghcr.io/ferretdb/postgres-documentdb:17@sha256:4a2364db8c91fd82855a4eab326202e247aa9ed6a6e8a85c76c1693a5a9ab408
    container_name: runtime-postgres
    hostname: postgres
    # documentdb does currently not support arm64
    platform: linux/amd64
    environment:
      POSTGRES_USER: root
      POSTGRES_PASSWORD: example
      POSTGRES_DB: postgres

  runtime-ferret:
    image: ghcr.io/ferretdb/ferretdb:2@sha256:7449f6ce1e75b187c328c9ce65ec4e8963767b34b4d604f9b9b6605c6d8d3ee7
    container_name: runtime-ferretdb
    ports:
      - "27022:27017"
    environment:
      FERRETDB_POSTGRESQL_URL: postgres://root:example@postgres:5432/postgres
    depends_on:
      - runtime-postgres
